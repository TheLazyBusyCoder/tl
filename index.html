<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Work Log</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #0f0f0f;
            color: #e0e0e0;
            line-height: 1.6;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #2a2a2a;
        }

        h1 {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .nav {
            display: flex;
            gap: 15px;
            margin-top: 15px;
        }

        .nav button {
            background: #1a1a1a;
            color: #e0e0e0;
            border: 1px solid #2a2a2a;
            padding: 8px 16px;
            cursor: pointer;
            font-size: 14px;
        }

        .nav button.active {
            background: #2a2a2a;
            border-color: #3a3a3a;
        }

        .nav button:hover {
            background: #252525;
        }

        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        .date-header {
            font-size: 18px;
            margin-bottom: 20px;
            color: #a0a0a0;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-size: 13px;
            color: #a0a0a0;
        }

        input, select, textarea {
            width: 100%;
            background: #1a1a1a;
            border: 1px solid #2a2a2a;
            color: #e0e0e0;
            padding: 8px 12px;
            font-size: 14px;
            font-family: inherit;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #3a3a3a;
        }

        textarea {
            resize: vertical;
            min-height: 80px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .form-row-three {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr;
            gap: 15px;
        }

        button {
            background: #1a1a1a;
            color: #e0e0e0;
            border: 1px solid #2a2a2a;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 14px;
            margin-top: 10px;
        }

        button:hover {
            background: #252525;
        }

        button:active {
            background: #2a2a2a;
        }

        .tasks-list {
            margin-top: 30px;
        }

        .task-item {
            background: #1a1a1a;
            border: 1px solid #2a2a2a;
            padding: 15px;
            margin-bottom: 10px;
        }

        .task-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .task-title {
            font-weight: 600;
            font-size: 15px;
        }

        .task-duration {
            color: #a0a0a0;
            font-size: 13px;
        }

        .task-meta {
            font-size: 13px;
            color: #808080;
            margin-bottom: 5px;
        }

        .task-outcome {
            font-size: 13px;
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px solid #252525;
        }

        .total-hours {
            margin-top: 20px;
            padding: 15px;
            background: #1a1a1a;
            border: 1px solid #2a2a2a;
            font-size: 16px;
        }

        .filters {
            background: #1a1a1a;
            border: 1px solid #2a2a2a;
            padding: 20px;
            margin-bottom: 20px;
        }

        .filter-row {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .export-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .report-section {
            margin-top: 30px;
        }

        .date-group {
            margin-bottom: 30px;
        }

        .date-group-header {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 10px;
            padding-bottom: 8px;
            border-bottom: 1px solid #2a2a2a;
        }

        .summary-box {
            background: #1a1a1a;
            border: 1px solid #2a2a2a;
            padding: 15px;
            margin-top: 10px;
            font-size: 13px;
            color: #a0a0a0;
        }

        .delete-btn {
            background: #2a1a1a;
            border-color: #3a2a2a;
            padding: 5px 10px;
            font-size: 12px;
            margin-left: 10px;
        }

        .delete-btn:hover {
            background: #3a2a2a;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Work Log</h1>
            <div class="nav">
                <button class="nav-btn active" data-page="log">Daily Log</button>
                <button class="nav-btn" data-page="reports">Reports</button>
            </div>
        </header>

        <div id="logPage" class="page active">
            <div class="date-header" id="todayDate"></div>

            <form id="taskForm">
                <div class="form-group">
                    <label>Task Title / Description</label>
                    <input type="text" id="taskTitle" required>
                </div>

                <div class="form-row-three">
                    <div class="form-group">
                        <label>Work Type</label>
                        <select id="workType" required>
                            <option value="Bug Fix">Bug Fix</option>
                            <option value="Feature">Feature</option>
                            <option value="Research">Research</option>
                            <option value="Meeting">Meeting</option>
                            <option value="Support">Support</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Start Time</label>
                        <input type="time" id="startTime" required>
                    </div>
                    <div class="form-group">
                        <label>End Time</label>
                        <input type="time" id="endTime" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Project / Module</label>
                        <input type="text" id="projectName" required>
                    </div>
                    <div class="form-group">
                        <label>Outcome / Result</label>
                        <input type="text" id="outcome" required>
                    </div>
                </div>

                <button type="submit">Add Task</button>
            </form>

            <div class="form-group" style="margin-top: 30px;">
                <label>Daily Summary (optional)</label>
                <textarea id="dailySummary" placeholder="Overall summary of your day..."></textarea>
                <button type="button" id="saveSummary">Save Summary</button>
            </div>

            <div class="tasks-list">
                <h2 style="margin-bottom: 15px; font-size: 18px;">Today's Tasks</h2>
                <div id="tasksList"></div>
                <div class="total-hours" id="totalHours">Total Hours: 0.00</div>
            </div>
        </div>

        <div id="reportsPage" class="page">
            <div class="filters">
                <div class="filter-row">
                    <div class="form-group">
                        <label>Date Range</label>
                        <select id="dateRange">
                            <option value="7">Past 7 days</option>
                            <option value="14">Past 14 days</option>
                            <option value="30">Past 30 days</option>
                            <option value="custom">Custom Range</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Start Date (if custom)</label>
                        <input type="date" id="startDate">
                    </div>
                    <div class="form-group">
                        <label>End Date (if custom)</label>
                        <input type="date" id="endDate">
                    </div>
                </div>
                <div class="filter-row">
                    <div class="form-group">
                        <label>Filter by Work Type</label>
                        <select id="filterWorkType">
                            <option value="">All</option>
                            <option value="Bug Fix">Bug Fix</option>
                            <option value="Feature">Feature</option>
                            <option value="Research">Research</option>
                            <option value="Meeting">Meeting</option>
                            <option value="Support">Support</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Filter by Project</label>
                        <input type="text" id="filterProject" placeholder="Leave empty for all">
                    </div>
                    <div class="form-group">
                        <button type="button" id="generateReport" style="margin-top: 24px;">Generate Report</button>
                    </div>
                </div>
            </div>

            <div class="total-hours" id="reportTotalHours">Total Hours: 0.00</div>

            <div class="export-buttons">
                <button id="exportCSV">Export CSV</button>
                <button id="exportText">Export Text Summary</button>
                <button id="copyText">Copy Text to Clipboard</button>
            </div>

            <div class="report-section" id="reportContent"></div>
        </div>
    </div>

    <script>
        // Storage key
        const STORAGE_KEY = 'worklog_data';

        // Get today's date in YYYY-MM-DD format
        function getTodayDate() {
            const today = new Date();
            return today.toISOString().split('T')[0];
        }

        // Format date for display
        function formatDate(dateStr) {
            const date = new Date(dateStr + 'T00:00:00');
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            return date.toLocaleDateString('en-US', options);
        }

        // Calculate duration in hours
        function calculateDuration(startTime, endTime) {
            const start = new Date('2000-01-01T' + startTime);
            const end = new Date('2000-01-01T' + endTime);
            let diff = (end - start) / (1000 * 60 * 60);
            if (diff < 0) diff += 24; // Handle overnight work
            return diff;
        }

        // Load data from localStorage
        function loadData() {
            const data = localStorage.getItem(STORAGE_KEY);
            return data ? JSON.parse(data) : {};
        }

        // Save data to localStorage
        function saveData(data) {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
        }

        // Get tasks for a specific date
        function getTasksForDate(date) {
            const data = loadData();
            return data[date] || { tasks: [], summary: '' };
        }

        // Save task for a specific date
        function saveTask(date, task) {
            const data = loadData();
            if (!data[date]) {
                data[date] = { tasks: [], summary: '' };
            }
            data[date].tasks.push(task);
            saveData(data);
        }

        // Save summary for a specific date
        function saveSummaryForDate(date, summary) {
            const data = loadData();
            if (!data[date]) {
                data[date] = { tasks: [], summary: '' };
            }
            data[date].summary = summary;
            saveData(data);
        }

        // Delete task
        function deleteTask(date, taskIndex) {
            const data = loadData();
            if (data[date] && data[date].tasks) {
                data[date].tasks.splice(taskIndex, 1);
                saveData(data);
            }
        }

        // Render tasks for today
        function renderTodayTasks() {
            const today = getTodayDate();
            const dayData = getTasksForDate(today);
            const tasksList = document.getElementById('tasksList');
            const totalHoursEl = document.getElementById('totalHours');

            if (dayData.tasks.length === 0) {
                tasksList.innerHTML = '<p style="color: #606060;">No tasks logged yet.</p>';
                totalHoursEl.textContent = 'Total Hours: 0.00';
                return;
            }

            let totalHours = 0;
            let html = '';

            dayData.tasks.forEach((task, index) => {
                const duration = calculateDuration(task.startTime, task.endTime);
                totalHours += duration;

                html += `
                    <div class="task-item">
                        <div class="task-header">
                            <div class="task-title">${task.title}</div>
                            <div class="task-duration">${duration.toFixed(2)}h</div>
                        </div>
                        <div class="task-meta">
                            ${task.workType} • ${task.project} • ${task.startTime} - ${task.endTime}
                        </div>
                        <div class="task-outcome">Result: ${task.outcome}</div>
                        <button class="delete-btn" onclick="handleDeleteTask(${index})">Delete</button>
                    </div>
                `;
            });

            tasksList.innerHTML = html;
            totalHoursEl.textContent = `Total Hours: ${totalHours.toFixed(2)}`;
        }

        // Handle delete task
        function handleDeleteTask(index) {
            const today = getTodayDate();
            if (confirm('Delete this task?')) {
                deleteTask(today, index);
                renderTodayTasks();
            }
        }

        // Load daily summary
        function loadDailySummary() {
            const today = getTodayDate();
            const dayData = getTasksForDate(today);
            document.getElementById('dailySummary').value = dayData.summary || '';
        }

        // Initialize daily log page
        function initDailyLog() {
            const today = getTodayDate();
            document.getElementById('todayDate').textContent = formatDate(today);
            renderTodayTasks();
            loadDailySummary();
        }

        // Handle task form submission
        document.getElementById('taskForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const task = {
                title: document.getElementById('taskTitle').value,
                workType: document.getElementById('workType').value,
                startTime: document.getElementById('startTime').value,
                endTime: document.getElementById('endTime').value,
                project: document.getElementById('projectName').value,
                outcome: document.getElementById('outcome').value
            };

            const today = getTodayDate();
            saveTask(today, task);
            renderTodayTasks();
            this.reset();
        });

        // Handle save summary
        document.getElementById('saveSummary').addEventListener('click', function() {
            const today = getTodayDate();
            const summary = document.getElementById('dailySummary').value;
            saveSummaryForDate(today, summary);
            alert('Summary saved');
        });

        // Navigation
        document.querySelectorAll('.nav-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const page = this.dataset.page;
                
                document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');

                document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
                document.getElementById(page + 'Page').classList.add('active');

                if (page === 'log') {
                    initDailyLog();
                }
            });
        });

        // Generate report
        document.getElementById('generateReport').addEventListener('click', function() {
            const rangeType = document.getElementById('dateRange').value;
            const workTypeFilter = document.getElementById('filterWorkType').value;
            const projectFilter = document.getElementById('filterProject').value.toLowerCase();

            let startDate, endDate;
            const today = new Date();

            if (rangeType === 'custom') {
                startDate = document.getElementById('startDate').value;
                endDate = document.getElementById('endDate').value;
                if (!startDate || !endDate) {
                    alert('Please select both start and end dates');
                    return;
                }
            } else {
                const days = parseInt(rangeType);
                endDate = getTodayDate();
                const start = new Date(today);
                start.setDate(start.getDate() - days + 1);
                startDate = start.toISOString().split('T')[0];
            }

            const data = loadData();
            const reportContent = document.getElementById('reportContent');
            let html = '';
            let totalHours = 0;
            const dateGroups = {};

            // Collect and filter tasks
            for (let date in data) {
                if (date >= startDate && date <= endDate) {
                    const dayData = data[date];
                    const filteredTasks = dayData.tasks.filter(task => {
                        if (workTypeFilter && task.workType !== workTypeFilter) return false;
                        if (projectFilter && !task.project.toLowerCase().includes(projectFilter)) return false;
                        return true;
                    });

                    if (filteredTasks.length > 0) {
                        dateGroups[date] = {
                            tasks: filteredTasks,
                            summary: dayData.summary
                        };
                    }
                }
            }

            // Sort dates descending
            const sortedDates = Object.keys(dateGroups).sort().reverse();

            if (sortedDates.length === 0) {
                reportContent.innerHTML = '<p style="color: #606060;">No tasks found for selected filters.</p>';
                document.getElementById('reportTotalHours').textContent = 'Total Hours: 0.00';
                return;
            }

            sortedDates.forEach(date => {
                const dayData = dateGroups[date];
                let dayHours = 0;

                html += `<div class="date-group">`;
                html += `<div class="date-group-header">${formatDate(date)}</div>`;

                dayData.tasks.forEach(task => {
                    const duration = calculateDuration(task.startTime, task.endTime);
                    dayHours += duration;
                    totalHours += duration;

                    html += `
                        <div class="task-item">
                            <div class="task-header">
                                <div class="task-title">${task.title}</div>
                                <div class="task-duration">${duration.toFixed(2)}h</div>
                            </div>
                            <div class="task-meta">
                                ${task.workType} • ${task.project} • ${task.startTime} - ${task.endTime}
                            </div>
                            <div class="task-outcome">Result: ${task.outcome}</div>
                        </div>
                    `;
                });

                if (dayData.summary) {
                    html += `<div class="summary-box"><strong>Summary:</strong> ${dayData.summary}</div>`;
                }

                html += `<div style="margin-top: 10px; color: #a0a0a0; font-size: 14px;">Day Total: ${dayHours.toFixed(2)}h</div>`;
                html += `</div>`;
            });

            reportContent.innerHTML = html;
            document.getElementById('reportTotalHours').textContent = `Total Hours: ${totalHours.toFixed(2)}`;
        });

        // Export CSV
        document.getElementById('exportCSV').addEventListener('click', function() {
            const reportContent = document.getElementById('reportContent');
            if (!reportContent.innerHTML || reportContent.innerHTML.includes('No tasks found')) {
                alert('Generate a report first');
                return;
            }

            const rangeType = document.getElementById('dateRange').value;
            const workTypeFilter = document.getElementById('filterWorkType').value;
            const projectFilter = document.getElementById('filterProject').value.toLowerCase();

            let startDate, endDate;
            const today = new Date();

            if (rangeType === 'custom') {
                startDate = document.getElementById('startDate').value;
                endDate = document.getElementById('endDate').value;
            } else {
                const days = parseInt(rangeType);
                endDate = getTodayDate();
                const start = new Date(today);
                start.setDate(start.getDate() - days + 1);
                startDate = start.toISOString().split('T')[0];
            }

            const data = loadData();
            let csv = 'Date,Task,Work Type,Project,Start Time,End Time,Duration (h),Outcome\n';

            for (let date in data) {
                if (date >= startDate && date <= endDate) {
                    const dayData = data[date];
                    dayData.tasks.forEach(task => {
                        if (workTypeFilter && task.workType !== workTypeFilter) return;
                        if (projectFilter && !task.project.toLowerCase().includes(projectFilter)) return;

                        const duration = calculateDuration(task.startTime, task.endTime);
                        csv += `${date},"${task.title}","${task.workType}","${task.project}",${task.startTime},${task.endTime},${duration.toFixed(2)},"${task.outcome}"\n`;
                    });
                }
            }

            const blob = new Blob([csv], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `worklog_${startDate}_to_${endDate}.csv`;
            a.click();
            URL.revokeObjectURL(url);
        });

        // Export text summary
        let cachedTextSummary = '';

        document.getElementById('exportText').addEventListener('click', function() {
            const reportContent = document.getElementById('reportContent');
            if (!reportContent.innerHTML || reportContent.innerHTML.includes('No tasks found')) {
                alert('Generate a report first');
                return;
            }

            const rangeType = document.getElementById('dateRange').value;
            const workTypeFilter = document.getElementById('filterWorkType').value;
            const projectFilter = document.getElementById('filterProject').value.toLowerCase();

            let startDate, endDate;
            const today = new Date();

            if (rangeType === 'custom') {
                startDate = document.getElementById('startDate').value;
                endDate = document.getElementById('endDate').value;
            } else {
                const days = parseInt(rangeType);
                endDate = getTodayDate();
                const start = new Date(today);
                start.setDate(start.getDate() - days + 1);
                startDate = start.toISOString().split('T')[0];
            }

            const data = loadData();
            let text = `Work Summary: ${startDate} to ${endDate}\n\n`;
            let totalHours = 0;

            const dateGroups = {};
            for (let date in data) {
                if (date >= startDate && date <= endDate) {
                    const dayData = data[date];
                    const filteredTasks = dayData.tasks.filter(task => {
                        if (workTypeFilter && task.workType !== workTypeFilter) return false;
                        if (projectFilter && !task.project.toLowerCase().includes(projectFilter)) return false;
                        return true;
                    });

                    if (filteredTasks.length > 0) {
                        dateGroups[date] = {
                            tasks: filteredTasks,
                            summary: dayData.summary
                        };
                    }
                }
            }

            const sortedDates = Object.keys(dateGroups).sort().reverse();

            sortedDates.forEach(date => {
                const dayData = dateGroups[date];
                text += `${formatDate(date)}:\n`;

                dayData.tasks.forEach(task => {
                    const duration = calculateDuration(task.startTime, task.endTime);
                    totalHours += duration;
                    text += `  - ${task.title} (${task.workType}, ${task.project}, ${duration.toFixed(2)}h)\n`;
                    text += `    Result: ${task.outcome}\n`;
                });

                if (dayData.summary) {
                    text += `  Summary: ${dayData.summary}\n`;
                }
                text += '\n';
            });

            text += `Total Hours: ${totalHours.toFixed(2)}`;

            cachedTextSummary = text;

            const blob = new Blob([text], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `worklog_summary_${startDate}_to_${endDate}.txt`;
            a.click();
            URL.revokeObjectURL(url);
        });

        // Copy text to clipboard
        document.getElementById('copyText').addEventListener('click', function() {
            if (!cachedTextSummary) {
                alert('Export text summary first');
                return;
            }

            navigator.clipboard.writeText(cachedTextSummary).then(() => {
                alert('Copied to clipboard');
            }).catch(err => {
                alert('Failed to copy to clipboard');
            });
        });

        // Initialize on load
        initDailyLog();
    </script>
</body>
</html>
 -->


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Work Log</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #0f0f0f;
            color: #e0e0e0;
            line-height: 1.6;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #2a2a2a;
        }

        h1 {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .nav {
            display: flex;
            gap: 15px;
            margin-top: 15px;
        }

        .nav button {
            background: #1a1a1a;
            color: #e0e0e0;
            border: 1px solid #2a2a2a;
            padding: 8px 16px;
            cursor: pointer;
            font-size: 14px;
        }

        .nav button.active {
            background: #2a2a2a;
            border-color: #3a3a3a;
        }

        .nav button:hover {
            background: #252525;
        }

        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        .date-header {
            font-size: 18px;
            margin-bottom: 20px;
            color: #a0a0a0;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-size: 13px;
            color: #a0a0a0;
        }

        input, select, textarea {
            width: 100%;
            background: #1a1a1a;
            border: 1px solid #2a2a2a;
            color: #e0e0e0;
            padding: 8px 12px;
            font-size: 14px;
            font-family: inherit;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #3a3a3a;
        }

        textarea {
            resize: vertical;
            min-height: 80px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .form-row-three {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr;
            gap: 15px;
        }

        button {
            background: #1a1a1a;
            color: #e0e0e0;
            border: 1px solid #2a2a2a;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 14px;
            margin-top: 10px;
        }

        button:hover {
            background: #252525;
        }

        button:active {
            background: #2a2a2a;
        }

        .tasks-list {
            margin-top: 30px;
        }

        .task-item {
            background: #1a1a1a;
            border: 1px solid #2a2a2a;
            padding: 15px;
            margin-bottom: 10px;
        }

        .task-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .task-title {
            font-weight: 600;
            font-size: 15px;
        }

        .task-duration {
            color: #a0a0a0;
            font-size: 13px;
        }

        .task-meta {
            font-size: 13px;
            color: #808080;
            margin-bottom: 5px;
        }

        .task-outcome {
            font-size: 13px;
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px solid #252525;
        }

        .total-hours {
            margin-top: 20px;
            padding: 15px;
            background: #1a1a1a;
            border: 1px solid #2a2a2a;
            font-size: 16px;
        }

        .filters {
            background: #1a1a1a;
            border: 1px solid #2a2a2a;
            padding: 20px;
            margin-bottom: 20px;
        }

        .filter-row {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .export-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .report-section {
            margin-top: 30px;
        }

        .date-group {
            margin-bottom: 30px;
        }

        .date-group-header {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 10px;
            padding-bottom: 8px;
            border-bottom: 1px solid #2a2a2a;
        }

        .summary-box {
            background: #1a1a1a;
            border: 1px solid #2a2a2a;
            padding: 15px;
            margin-top: 10px;
            font-size: 13px;
            color: #a0a0a0;
        }

        .delete-btn {
            background: #2a1a1a;
            border-color: #3a2a2a;
            padding: 5px 10px;
            font-size: 12px;
            margin-left: 10px;
        }

        .delete-btn:hover {
            background: #3a2a2a;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Work Log</h1>
            <div class="nav">
                <button class="nav-btn active" data-page="log">Daily Log</button>
                <button class="nav-btn" data-page="reports">Reports</button>
            </div>
        </header>

        <div id="logPage" class="page active">
            <div class="date-header" id="todayDate"></div>

            <div class="form-group">
                <label>Bulk Import Tasks</label>
                <div style="display: flex; gap: 10px;">
                    <button type="button" id="downloadTemplate">Download CSV Template</button>
                    <input type="file" id="csvUpload" accept=".csv" style="display: none;">
                    <button type="button" id="uploadCSV">Upload Filled CSV</button>
                </div>
            </div>

            <form id="taskForm">
                <div class="form-group">
                    <label>Task Title / Description</label>
                    <input type="text" id="taskTitle" required>
                </div>

                <div class="form-row-three">
                    <div class="form-group">
                        <label>Work Type</label>
                        <select id="workType" required>
                            <option value="Bug Fix">Bug Fix</option>
                            <option value="Feature">Feature</option>
                            <option value="Research">Research</option>
                            <option value="Meeting">Meeting</option>
                            <option value="Support">Support</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Start Time</label>
                        <input type="time" id="startTime" required>
                    </div>
                    <div class="form-group">
                        <label>End Time</label>
                        <input type="time" id="endTime" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Project / Module</label>
                        <input type="text" id="projectName" required>
                    </div>
                    <div class="form-group">
                        <label>Outcome / Result</label>
                        <input type="text" id="outcome" required>
                    </div>
                </div>

                <button type="submit">Add Task</button>
            </form>

            <div class="form-group" style="margin-top: 30px;">
                <label>Daily Summary (optional)</label>
                <textarea id="dailySummary" placeholder="Overall summary of your day..."></textarea>
                <button type="button" id="saveSummary">Save Summary</button>
            </div>

            <div class="tasks-list">
                <h2 style="margin-bottom: 15px; font-size: 18px;">Today's Tasks</h2>
                <div id="tasksList"></div>
                <div class="total-hours" id="totalHours">Total Hours: 0.00</div>
            </div>
        </div>

        <div id="reportsPage" class="page">
            <div class="filters">
                <div class="filter-row">
                    <div class="form-group">
                        <label>Date Range</label>
                        <select id="dateRange">
                            <option value="7">Past 7 days</option>
                            <option value="14">Past 14 days</option>
                            <option value="30">Past 30 days</option>
                            <option value="custom">Custom Range</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Start Date (if custom)</label>
                        <input type="date" id="startDate">
                    </div>
                    <div class="form-group">
                        <label>End Date (if custom)</label>
                        <input type="date" id="endDate">
                    </div>
                </div>
                <div class="filter-row">
                    <div class="form-group">
                        <label>Filter by Work Type</label>
                        <select id="filterWorkType">
                            <option value="">All</option>
                            <option value="Bug Fix">Bug Fix</option>
                            <option value="Feature">Feature</option>
                            <option value="Research">Research</option>
                            <option value="Meeting">Meeting</option>
                            <option value="Support">Support</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Filter by Project</label>
                        <input type="text" id="filterProject" placeholder="Leave empty for all">
                    </div>
                    <div class="form-group">
                        <button type="button" id="generateReport" style="margin-top: 24px;">Generate Report</button>
                    </div>
                </div>
            </div>

            <div class="total-hours" id="reportTotalHours">Total Hours: 0.00</div>

            <div class="export-buttons">
                <button id="exportCSV">Export CSV</button>
                <button id="exportText">Export Text Summary</button>
                <button id="copyText">Copy Text to Clipboard</button>
            </div>

            <div class="report-section" id="reportContent"></div>
        </div>
    </div>

    <script>
        // Storage key
        const STORAGE_KEY = 'worklog_data';

        // Get today's date in YYYY-MM-DD format
        function getTodayDate() {
            const today = new Date();
            return today.toISOString().split('T')[0];
        }

        // Format date for display
        function formatDate(dateStr) {
            const date = new Date(dateStr + 'T00:00:00');
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            return date.toLocaleDateString('en-US', options);
        }

        // Calculate duration in hours
        function calculateDuration(startTime, endTime) {
            const start = new Date('2000-01-01T' + startTime);
            const end = new Date('2000-01-01T' + endTime);
            let diff = (end - start) / (1000 * 60 * 60);
            if (diff < 0) diff += 24; // Handle overnight work
            return diff;
        }

        // Load data from localStorage
        function loadData() {
            const data = localStorage.getItem(STORAGE_KEY);
            return data ? JSON.parse(data) : {};
        }

        // Save data to localStorage
        function saveData(data) {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
        }

        // Get tasks for a specific date
        function getTasksForDate(date) {
            const data = loadData();
            return data[date] || { tasks: [], summary: '' };
        }

        // Save task for a specific date
        function saveTask(date, task) {
            const data = loadData();
            if (!data[date]) {
                data[date] = { tasks: [], summary: '' };
            }
            data[date].tasks.push(task);
            saveData(data);
        }

        // Save summary for a specific date
        function saveSummaryForDate(date, summary) {
            const data = loadData();
            if (!data[date]) {
                data[date] = { tasks: [], summary: '' };
            }
            data[date].summary = summary;
            saveData(data);
        }

        // Delete task
        function deleteTask(date, taskIndex) {
            const data = loadData();
            if (data[date] && data[date].tasks) {
                data[date].tasks.splice(taskIndex, 1);
                saveData(data);
            }
        }

        // Render tasks for today
        function renderTodayTasks() {
            const today = getTodayDate();
            const dayData = getTasksForDate(today);
            const tasksList = document.getElementById('tasksList');
            const totalHoursEl = document.getElementById('totalHours');

            if (dayData.tasks.length === 0) {
                tasksList.innerHTML = '<p style="color: #606060;">No tasks logged yet.</p>';
                totalHoursEl.textContent = 'Total Hours: 0.00';
                return;
            }

            let totalHours = 0;
            let html = '';

            dayData.tasks.forEach((task, index) => {
                const duration = calculateDuration(task.startTime, task.endTime);
                totalHours += duration;

                html += `
                    <div class="task-item">
                        <div class="task-header">
                            <div class="task-title">${task.title}</div>
                            <div class="task-duration">${duration.toFixed(2)}h</div>
                        </div>
                        <div class="task-meta">
                            ${task.workType} • ${task.project} • ${task.startTime} - ${task.endTime}
                        </div>
                        <div class="task-outcome">Result: ${task.outcome}</div>
                        <button class="delete-btn" onclick="handleDeleteTask(${index})">Delete</button>
                    </div>
                `;
            });

            tasksList.innerHTML = html;
            totalHoursEl.textContent = `Total Hours: ${totalHours.toFixed(2)}`;
        }

        // Handle delete task
        function handleDeleteTask(index) {
            const today = getTodayDate();
            if (confirm('Delete this task?')) {
                deleteTask(today, index);
                renderTodayTasks();
            }
        }

        // Load daily summary
        function loadDailySummary() {
            const today = getTodayDate();
            const dayData = getTasksForDate(today);
            document.getElementById('dailySummary').value = dayData.summary || '';
        }

        // Initialize daily log page
        function initDailyLog() {
            const today = getTodayDate();
            document.getElementById('todayDate').textContent = formatDate(today);
            renderTodayTasks();
            loadDailySummary();
        }

        // Handle task form submission
        document.getElementById('taskForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const task = {
                title: document.getElementById('taskTitle').value,
                workType: document.getElementById('workType').value,
                startTime: document.getElementById('startTime').value,
                endTime: document.getElementById('endTime').value,
                project: document.getElementById('projectName').value,
                outcome: document.getElementById('outcome').value
            };

            const today = getTodayDate();
            saveTask(today, task);
            renderTodayTasks();
            this.reset();
        });

        // Handle save summary
        document.getElementById('saveSummary').addEventListener('click', function() {
            const today = getTodayDate();
            const summary = document.getElementById('dailySummary').value;
            saveSummaryForDate(today, summary);
            alert('Summary saved');
        });

        // Download CSV template
        document.getElementById('downloadTemplate').addEventListener('click', function() {
            const csv = 'Task Title,Work Type,Start Time,End Time,Project,Outcome\n' +
                        'Example Task,Feature,09:00,11:00,My Project,Completed successfully\n';
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'worklog_template.csv';
            a.click();
            URL.revokeObjectURL(url);
        });

        // Upload CSV
        document.getElementById('uploadCSV').addEventListener('click', function() {
            document.getElementById('csvUpload').click();
        });

        document.getElementById('csvUpload').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(event) {
                const csv = event.target.result;
                const lines = csv.split('\n');
                const today = getTodayDate();
                let imported = 0;

                // Skip header row
                for (let i = 1; i < lines.length; i++) {
                    const line = lines[i].trim();
                    if (!line) continue;

                    // Parse CSV line (handle quoted values)
                    const matches = line.match(/(".*?"|[^,]+)(?=\s*,|\s*$)/g);
                    if (!matches || matches.length < 6) continue;

                    const task = {
                        title: matches[0].replace(/^"|"$/g, '').trim(),
                        workType: matches[1].replace(/^"|"$/g, '').trim(),
                        startTime: matches[2].replace(/^"|"$/g, '').trim(),
                        endTime: matches[3].replace(/^"|"$/g, '').trim(),
                        project: matches[4].replace(/^"|"$/g, '').trim(),
                        outcome: matches[5].replace(/^"|"$/g, '').trim()
                    };

                    // Validate required fields
                    if (task.title && task.workType && task.startTime && task.endTime && task.project && task.outcome) {
                        saveTask(today, task);
                        imported++;
                    }
                }

                if (imported > 0) {
                    alert(`Successfully imported ${imported} task(s)`);
                    renderTodayTasks();
                } else {
                    alert('No valid tasks found in the CSV file');
                }

                // Reset file input
                e.target.value = '';
            };

            reader.readAsText(file);
        });

        // Navigation
        document.querySelectorAll('.nav-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const page = this.dataset.page;
                
                document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');

                document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
                document.getElementById(page + 'Page').classList.add('active');

                if (page === 'log') {
                    initDailyLog();
                }
            });
        });

        // Generate report
        document.getElementById('generateReport').addEventListener('click', function() {
            const rangeType = document.getElementById('dateRange').value;
            const workTypeFilter = document.getElementById('filterWorkType').value;
            const projectFilter = document.getElementById('filterProject').value.toLowerCase();

            let startDate, endDate;
            const today = new Date();

            if (rangeType === 'custom') {
                startDate = document.getElementById('startDate').value;
                endDate = document.getElementById('endDate').value;
                if (!startDate || !endDate) {
                    alert('Please select both start and end dates');
                    return;
                }
            } else {
                const days = parseInt(rangeType);
                endDate = getTodayDate();
                const start = new Date(today);
                start.setDate(start.getDate() - days + 1);
                startDate = start.toISOString().split('T')[0];
            }

            const data = loadData();
            const reportContent = document.getElementById('reportContent');
            let html = '';
            let totalHours = 0;
            const dateGroups = {};

            // Collect and filter tasks
            for (let date in data) {
                if (date >= startDate && date <= endDate) {
                    const dayData = data[date];
                    const filteredTasks = dayData.tasks.filter(task => {
                        if (workTypeFilter && task.workType !== workTypeFilter) return false;
                        if (projectFilter && !task.project.toLowerCase().includes(projectFilter)) return false;
                        return true;
                    });

                    if (filteredTasks.length > 0) {
                        dateGroups[date] = {
                            tasks: filteredTasks,
                            summary: dayData.summary
                        };
                    }
                }
            }

            // Sort dates descending
            const sortedDates = Object.keys(dateGroups).sort().reverse();

            if (sortedDates.length === 0) {
                reportContent.innerHTML = '<p style="color: #606060;">No tasks found for selected filters.</p>';
                document.getElementById('reportTotalHours').textContent = 'Total Hours: 0.00';
                return;
            }

            sortedDates.forEach(date => {
                const dayData = dateGroups[date];
                let dayHours = 0;

                html += `<div class="date-group">`;
                html += `<div class="date-group-header">${formatDate(date)}</div>`;

                dayData.tasks.forEach(task => {
                    const duration = calculateDuration(task.startTime, task.endTime);
                    dayHours += duration;
                    totalHours += duration;

                    html += `
                        <div class="task-item">
                            <div class="task-header">
                                <div class="task-title">${task.title}</div>
                                <div class="task-duration">${duration.toFixed(2)}h</div>
                            </div>
                            <div class="task-meta">
                                ${task.workType} • ${task.project} • ${task.startTime} - ${task.endTime}
                            </div>
                            <div class="task-outcome">Result: ${task.outcome}</div>
                        </div>
                    `;
                });

                if (dayData.summary) {
                    html += `<div class="summary-box"><strong>Summary:</strong> ${dayData.summary}</div>`;
                }

                html += `<div style="margin-top: 10px; color: #a0a0a0; font-size: 14px;">Day Total: ${dayHours.toFixed(2)}h</div>`;
                html += `</div>`;
            });

            reportContent.innerHTML = html;
            document.getElementById('reportTotalHours').textContent = `Total Hours: ${totalHours.toFixed(2)}`;
        });

        // Export CSV
        document.getElementById('exportCSV').addEventListener('click', function() {
            const reportContent = document.getElementById('reportContent');
            if (!reportContent.innerHTML || reportContent.innerHTML.includes('No tasks found')) {
                alert('Generate a report first');
                return;
            }

            const rangeType = document.getElementById('dateRange').value;
            const workTypeFilter = document.getElementById('filterWorkType').value;
            const projectFilter = document.getElementById('filterProject').value.toLowerCase();

            let startDate, endDate;
            const today = new Date();

            if (rangeType === 'custom') {
                startDate = document.getElementById('startDate').value;
                endDate = document.getElementById('endDate').value;
            } else {
                const days = parseInt(rangeType);
                endDate = getTodayDate();
                const start = new Date(today);
                start.setDate(start.getDate() - days + 1);
                startDate = start.toISOString().split('T')[0];
            }

            const data = loadData();
            let csv = 'Date,Task,Work Type,Project,Start Time,End Time,Duration (h),Outcome\n';

            for (let date in data) {
                if (date >= startDate && date <= endDate) {
                    const dayData = data[date];
                    dayData.tasks.forEach(task => {
                        if (workTypeFilter && task.workType !== workTypeFilter) return;
                        if (projectFilter && !task.project.toLowerCase().includes(projectFilter)) return;

                        const duration = calculateDuration(task.startTime, task.endTime);
                        csv += `${date},"${task.title}","${task.workType}","${task.project}",${task.startTime},${task.endTime},${duration.toFixed(2)},"${task.outcome}"\n`;
                    });
                }
            }

            const blob = new Blob([csv], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `worklog_${startDate}_to_${endDate}.csv`;
            a.click();
            URL.revokeObjectURL(url);
        });

        // Export text summary
        let cachedTextSummary = '';

        document.getElementById('exportText').addEventListener('click', function() {
            const reportContent = document.getElementById('reportContent');
            if (!reportContent.innerHTML || reportContent.innerHTML.includes('No tasks found')) {
                alert('Generate a report first');
                return;
            }

            const rangeType = document.getElementById('dateRange').value;
            const workTypeFilter = document.getElementById('filterWorkType').value;
            const projectFilter = document.getElementById('filterProject').value.toLowerCase();

            let startDate, endDate;
            const today = new Date();

            if (rangeType === 'custom') {
                startDate = document.getElementById('startDate').value;
                endDate = document.getElementById('endDate').value;
            } else {
                const days = parseInt(rangeType);
                endDate = getTodayDate();
                const start = new Date(today);
                start.setDate(start.getDate() - days + 1);
                startDate = start.toISOString().split('T')[0];
            }

            const data = loadData();
            let text = `Work Summary: ${startDate} to ${endDate}\n\n`;
            let totalHours = 0;

            const dateGroups = {};
            for (let date in data) {
                if (date >= startDate && date <= endDate) {
                    const dayData = data[date];
                    const filteredTasks = dayData.tasks.filter(task => {
                        if (workTypeFilter && task.workType !== workTypeFilter) return false;
                        if (projectFilter && !task.project.toLowerCase().includes(projectFilter)) return false;
                        return true;
                    });

                    if (filteredTasks.length > 0) {
                        dateGroups[date] = {
                            tasks: filteredTasks,
                            summary: dayData.summary
                        };
                    }
                }
            }

            const sortedDates = Object.keys(dateGroups).sort().reverse();

            sortedDates.forEach(date => {
                const dayData = dateGroups[date];
                text += `${formatDate(date)}:\n`;

                dayData.tasks.forEach(task => {
                    const duration = calculateDuration(task.startTime, task.endTime);
                    totalHours += duration;
                    text += `  - ${task.title} (${task.workType}, ${task.project}, ${duration.toFixed(2)}h)\n`;
                    text += `    Result: ${task.outcome}\n`;
                });

                if (dayData.summary) {
                    text += `  Summary: ${dayData.summary}\n`;
                }
                text += '\n';
            });

            text += `Total Hours: ${totalHours.toFixed(2)}`;

            cachedTextSummary = text;

            const blob = new Blob([text], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `worklog_summary_${startDate}_to_${endDate}.txt`;
            a.click();
            URL.revokeObjectURL(url);
        });

        // Copy text to clipboard
        document.getElementById('copyText').addEventListener('click', function() {
            if (!cachedTextSummary) {
                alert('Export text summary first');
                return;
            }

            navigator.clipboard.writeText(cachedTextSummary).then(() => {
                alert('Copied to clipboard');
            }).catch(err => {
                alert('Failed to copy to clipboard');
            });
        });

        // Initialize on load
        initDailyLog();
    </script>
</body>
</html>
